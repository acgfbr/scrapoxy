<ng-container [formGroup]="subForm">
    @if (subForm.controls['apiUrl']; as c) {
        <c-row>
            <c-col><h5 class="card-title">API</h5></c-col>
        </c-row>

        <c-row>
            <label cLabel cCol md="2" for="apiUrl">URL</label>

            <c-col md="10">
                <input
                    type="text"
                    cFormControl
                    id="apiUrl"
                    formControlName="apiUrl"
                    placeholder="Enter the URL of the API"
                    (focusout)="apiUrlFocusOut()"
                    [valid]="c.dirty || c.touched ? c.valid : undefined" />

                @if (c.dirty || c.touched) {
                    <c-form-feedback [valid]="c.valid">
                        @if (c.errors; as errs) {
                            @if (errs['required']) {
                                <div>URL is required.</div>
                            }
                            @if (errs['url']) {
                                <div>URL has a wrong format.</div>
                            }
                        }
                    </c-form-feedback>
                }
            </c-col>
        </c-row>
    }
    @if (subForm.controls['apiUsername']; as c) {
        <c-row>
            <label cLabel cCol md="2" for="apiUsername">Username</label>

            <c-col md="10">
                <input
                    type="text"
                    cFormControl
                    id="apiUsername"
                    formControlName="apiUsername"
                    placeholder="Enter the username of the auth API"
                    [valid]="c.dirty || c.touched ? c.valid : undefined" />

                @if (c.dirty || c.touched) {
                    <c-form-feedback [valid]="c.valid">
                        @if (c.errors; as errs) {
                            @if (errs['required']) {
                                <div>Username is required.</div>
                            }
                        }
                    </c-form-feedback>
                }
            </c-col>
        </c-row>
    }
    @if (subForm.controls['apiPassword']; as c) {
        <c-row>
            <label cLabel cCol md="2" for="apiPassword">Password</label>

            <c-col md="10">
                <c-input-group class="has-validation">
                    <input
                        [type]="apiPasswordType"
                        cFormControl
                        id="apiPassword"
                        formControlName="apiPassword"
                        placeholder="Enter the API Password"
                        autocomplete="off"
                        data-form-type="other"
                        data-lpignore="true"
                        [valid]="c.dirty || c.touched ? c.valid : undefined" />

                    <button
                        cButton
                        color="secondary"
                        variant="outline"
                        cTooltip="Show API password"
                        cTooltipPlacement="top"
                        (click)="toggleApiPasswordType()">
                        <svg cIcon name="cilEye"></svg>
                    </button>

                    @if (c.dirty || c.touched) {
                        <c-form-feedback [valid]="c.valid">
                            @if (c.errors; as errs) {
                                @if (errs['required']) {
                                    <div>API Password is required.</div>
                                }
                            }
                        </c-form-feedback>
                    }
                </c-input-group>
            </c-col>
        </c-row>
    }
    @if (subForm.controls['proxyHostname']; as c) {
        <c-row>
            <c-col><h5 class="card-title">Proxy</h5></c-col>
        </c-row>

        <c-row>
            <label cLabel cCol md="2" for="proxyHostname">Hostname</label>

            <c-col md="10">
                <input
                    type="text"
                    cFormControl
                    id="proxyHostname"
                    formControlName="proxyHostname"
                    placeholder="Enter the proxy hostname"
                    [valid]="c.dirty || c.touched ? c.valid : undefined" />

                @if (c.dirty || c.touched) {
                    <c-form-feedback [valid]="c.valid">
                        @if (c.errors; as errs) {
                            @if (errs['required']) {
                                <div>Hostname is required.</div>
                            }
                        }
                    </c-form-feedback>
                }
            </c-col>
        </c-row>
    }
    @if (subForm.controls['proxyUsername']; as c) {
        <c-row>
            <label cLabel cCol md="2" for="proxyUsername">Username</label>

            <c-col md="10">
                <input
                    type="text"
                    cFormControl
                    id="proxyUsername"
                    formControlName="proxyUsername"
                    placeholder="Enter the proxy username"
                    [valid]="c.dirty || c.touched ? c.valid : undefined" />

                @if (c.dirty || c.touched) {
                    <c-form-feedback [valid]="c.valid">
                        @if (c.errors; as errs) {
                            @if (errs['required']) {
                                <div>Username is required.</div>
                            }
                        }
                    </c-form-feedback>
                }
            </c-col>
        </c-row>
    }
    @if (subForm.controls['proxyPassword']; as c) {
        <c-row>
            <label cLabel cCol md="2" for="proxyPassword">Password</label>

            <c-col md="10">
                <c-input-group class="has-validation">
                    <input
                        [type]="proxyPasswordType"
                        cFormControl
                        id="proxyPassword"
                        formControlName="proxyPassword"
                        placeholder="Enter the proxy password"
                        autocomplete="off"
                        data-form-type="other"
                        data-lpignore="true"
                        [valid]="c.dirty || c.touched ? c.valid : undefined" />

                    <button
                        cButton
                        color="secondary"
                        variant="outline"
                        cTooltip="Show proxy password"
                        cTooltipPlacement="top"
                        (click)="toggleProxyPasswordType()">
                        <svg cIcon name="cilEye"></svg>
                    </button>

                    @if (c.dirty || c.touched) {
                        <c-form-feedback [valid]="c.valid">
                            @if (c.errors; as errs) {
                                @if (errs['required']) {
                                    <div>Password is required.</div>
                                }
                            }
                        </c-form-feedback>
                    }
                </c-input-group>
            </c-col>
        </c-row>
    }
</ng-container>
